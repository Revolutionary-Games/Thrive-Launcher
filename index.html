<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="Content-Security-Policy"
          content="default-src 'self'; style-src 'self' 'unsafe-inline';
                   font-src 'self' data;
                   script-src 'self' 'unsafe-inline';
                   img-src 'self' http: https: data:;
                   media-src 'self' http: https:;
                   connect-src http: https:;">
    <link rel="stylesheet" href="Roboto/roboto.css">
    <link rel="stylesheet" href="jquery-ui-1.12.1/jquery-ui.min.css">
    <link href="thrive.css" rel="stylesheet">
    <title>Thrive Launcher</title>
  </head>
  <body>
    <div id="titleBar">
      <div id="titleDraggableRegion">
        <img class="TopLogo" src="assets/icons/128x128.png" width="15px" height="15px">
        <span class="TopLogo">Thrive Launcher</span>
        <div class="WindowButton" id="windowClose">
          <svg viewBox="0 0 24 24" width="15" height="15"><path d="M20.84 18.01C21.62 18.79 21.62 20.06 20.84 20.84C20.56 21.12 21.12 20.56 20.84 20.84C20.06 21.62 18.79 21.62 18.01 20.84C14.76 17.59 6.41 9.24 3.16 5.99C2.38 5.21 2.38 3.94 3.16 3.16C3.44 2.88 2.88 3.44 3.16 3.16C3.94 2.38 5.21 2.38 5.99 3.16C9.24 6.41 17.59 14.76 20.84 18.01Z" opacity="1" fill="currentColor" fill-opacity="1"/><path d="M5.99 20.84C5.21 21.62 3.94 21.62 3.16 20.84C2.88 20.56 3.44 21.12 3.16 20.84C2.38 20.06 2.38 18.79 3.16 18.01C6.41 14.76 14.76 6.41 18.01 3.16C18.79 2.38 20.06 2.38 20.84 3.16C21.12 3.44 20.56 2.88 20.84 3.16C21.62 3.94 21.62 5.21 20.84 5.99C17.59 9.24 9.24 17.59 5.99 20.84Z" opacity="1" fill="currentColor" fill-opacity="1"/></svg>
        </div>
        <div class="WindowButton" id="windowMaximize">
          <svg  viewBox="0 0 24 24" width="20" height="20">
            <g transform="translate(0,24) scale(0.1,-0.1)" fill="currentColor" stroke="none">
              <path d="M40 120 l0 -80 80 0 80 0 0 80 0 80 -80 0 -80 0 0 -80z m140 0 l0 -60 -60 0 -60 0 0 60 0 60 60 0 60 0 0 -60z"/>
            </g>
          </svg>
        </div>
        <div class="WindowButton" id="windowMinimize">
          <svg viewBox="0 0 24 24" width="24" height="24"><path d="M19.39 12C19.73 12 20 12.28 20 12.62C20 12.9 20 13.11 20 13.39C20 13.73 19.73 14 19.39 14C16.31 14 7.69 14 4.62 14C4.28 14 4 13.73 4 13.39C4 13.11 4 12.9 4 12.62C4 12.28 4.28 12 4.62 12C7.69 12.01 16.31 12.01 19.39 12Z" opacity="1" fill="currentColor" fill-opacity="1"/></svg>
        </div>
      </div>
    </div>
    <span class="ContentBlock"
          style="height: calc(80% - 15px); width: calc(40% - 20px); top: 35px; margin-left: 8px;
                 rgba(68, 68, 68, 0.46)">

        <h2>DEVELOPMENT FORUMS</h2>
        <hr>

        <span id="devForumPosts">
        </span>

        <div class="BottomFade"
        style="height: 6%; width: calc(40% - 20px); bottom: calc(20% - 22px); left: 8px;">
      </div>
    </span>

    <span class="ContentBlock"
          style="height: calc(80% - 15px); width: calc(60% - 10px); top: 35px; left: calc(40% + 1px);">

        <h2 style="padding-left: 20px;">NEWS</h2>
        <hr>
        <span id="newsContent">
        </span>

        <div class="BottomFade"
        style="height: 6%; width: calc(60% - 10px); bottom: calc(20% - 22px); left: calc(40% + 1px);">
        </div>
    </span>

    <div id="buttonContainerParent">
      <span id="buttonContainerLeft">
        <span class="InnerButtons">
          <!-- Links button -->
          <div id="linksButton" class="BottomButton" style="">
            <p style="text-align: left;">
              Links
            </p>
          </div>
          <!-- Settings button -->
          <div id="settingsButton" class="BottomButton" style="padding-top: 3px; padding-bottom: 3px;">
            <img src="assets/gear.png" style="width: 36px; height: 36px; padding-top: 5px; padding-bottom: 3px;">
          </div>

          <div id="playButton" class="BottomButton">

            <span id="playText" class="Inline" style="padding-left: 10px; padding-bottom: 10px;
                                                      padding-top: 10px; color: white;">
              Play
            </span>
            <span id="playComboPopup" class="Inline"
                  style="border-left: 4px solid #55dbdb; padding-bottom: 3px; padding-top: 3px;
                        padding-left: 12px; padding-right: 12px; vertical-align: middle; font-size: 1.7em;">&#x21E7
            </span>
          </div>
        </span>
      </span>
      <span id="buttonContainerRight">
          <!-- DevCenter status and popup open button -->
          <div id="devCenterStatus" class="DevCenterStatusBox">
            <span id="devCenterStatusMessage">Loading...</span>
            <a href="#" id="devCenterPopupOpen"></a>
          </div>
      </span>
    </div>

    <!-- Popup for the version select combobox -->
    <div id="playComboBackground" class="ComboPopup">
        <div id="versionSelectPopup" class="ComboContent">
        </div>
    </div>

    <!-- Incompatible Popup -->
    <div id="incompatibleModal" class="modal">
      <div id="incompatibleModalDialog" class="modal-content" style="max-height: 80%;">
        <span id="incompatibleModalClose" class="close">&times;</span>
        <span id="incompatibleModalContent"></span>
      </div>
    </div>

    <!-- Moving file loading Popup -->
    <div id="movingFileModal" class="modal" style="z-index: 2;">
      <div id="movingFileModalDialog" class="modal-content" style="z-index: 2; margin-top: 15%; max-height: 80%;">
        <span id="movingFileModalContent"></span>
      </div>
    </div>

    <!-- Popup Launching window -->
    <div id="playModal" class="modal">
      <div id="playModalDialog" class="modal-content" style="position: absolute; margin-top: auto; max-height: 500px; width: 650px; max-width: 650px;
                                                            margin: 0; margin-top:25px; top: 15%; left: 50%; transform: translateX(-50%) translateY(-14%); overflow: hidden;">
        <span id="playModalClose" class="close">&times;</span>
        <span id="playModalContent">An unknown error happened</span>
      </div>
    </div>

    <!-- Links popup -->
    <div id="linksModal" class="modal">
      <div id="linksModalDialog" class="modal-content"
           style="background: linear-gradient(to top left, rgb(68, 68, 68), rgba(48, 48, 48, 0.95))">

        <span id="linksClose" class="close">&times;</span>

        <div><a class="SiteLink" style="font-size: 1.4em;"
                href="https://revolutionarygamesstudio.com/">Main website</a></div>

        <hr>
        <div><a class="SiteLink"
                href="https://forum.revolutionarygamesstudio.com/">Development forums</a></div>

        <div><a class="SiteLink"
                href="https://community.revolutionarygamesstudio.com/">Community forums</a></div>

        <div><a class="SiteLink"
                href="https://github.com/Revolutionary-Games/Thrive">Thrive on GitHub</a></div>

        <div><a class="SiteLink"
                href="https://www.patreon.com/thrivegame">Patreon</a></div>

        <div><a class="SiteLink"
                href="https://github.com/Revolutionary-Games/Thrive-Launcher">
                Launcher on GitHub</a></div>

        <div><a class="SiteLink"
                href="https://wiki.revolutionarygamesstudio.com/">Developer Wiki</a></div>

        <div><a class="SiteLink"
                href="https://dev.revolutionarygamesstudio.com/">ThriveDevCenter</a></div>

        <div><a class="SiteLink"
                href="http://thrive.wikia.com/wiki/Thrive_Wiki">Fan Wiki</a></div>
        <hr>

        <div><a class="SiteLink"
                href="https://discord.gg/FZxDQ4H">Discord server</a></div>

        <div><a class="SiteLink"
                href="https://www.reddit.com/r/thrive">Subreddit</a></div>

        <div><a class="SiteLink"
                href="https://www.youtube.com/c/RevolutionaryGames">YouTube channel</a></div>

        <div><a class="SiteLink"
                href="https://www.facebook.com/Thrive-182887991751358/">Facebook page</a></div>

        <div><a class="SiteLink"
                href="https://twitter.com/thrive_game">Twitter feed</a></div>
      </div>
    </div>

    <!-- Settings popup -->
    <div id="settingsModal" class="modal">
      <div id="settingsModalDialog" class="modal-content">

        <span id="settingsClose" class="close"
              style="position: relative; right: 15px; top: 8px;">&times;</span>

        <div id="settingsTabs">
          <ul>
            <li><a href="#settingsTabs-1">Installed Versions</a></li>
            <li><a href="#settingsTabs-2">Launcher Options</a></li>
            <li><a href="#settingsTabs-3">Thrive Options</a></li>
            <li><a href="#settingsTabs-4">Cache</a></li>
          </ul>
          <div id="settingsTabs-1">
            <div id="browseFilesButton" class="BottomButton" style="height: 40px;">
              <p style="text-align: left; font-size: 0.8em;">
                Browse Installed Files
              </p>
            </div>
            <div id="selectInstallLocation" class="BottomButton" style="height: 40px;">
              <p style="text-align: left; font-size: 0.8em;">
                Select Install Location
              </p>
            </div>
            <div id="resetInstallLocation" class="BottomButton" style="font-size: 1.5em; vertical-align: middle;">
                <div class="ResetInstallLocationTooltip">&#x21bb
                  <span class="ResetInstallLocationTooltipText">Reset Install Location</span>
                </div>
            </div>
            <hr/>
            <span id="currentInstallDir" class="Inline" style="font-size: 0.8em;">
              Directory: ...
            </span>
            <ul id="listOfInstalledVersions">
            </ul>
          </div>
          <div id="settingsTabs-2">
            <div>
              <label for="enableWebContentCheckbox">Enable Web Content</label>
              <input type="checkbox" id="enableWebContentCheckbox">
            </div>
            <div>
              <label for="hideLauncherOnPlay">Hide Launcher On Play</label>
              <input type="checkbox" id="hideLauncherOnPlay">
            </div>
            <hr />
            <div id="resetAllSettingsButton" class="BottomButton Dangerous"
                 style="height: 40px;">
              <p style="text-align: left; font-size: 0.8em;">
                Reset All Settings
              </p>
            </div>
          </div>
          <div id="settingsTabs-3">
            <div>Launch Options</div>
            <hr />
            <div class="Inline" style="margin-top: 15px;">
              Pre 0.5.0 options (don't try these for newer versions!)
              <br>
              CEF workarounds (try if the game doesn't start with 0.4.3 or earlier)
            </div>
            <div>
              <label for="enableSingleProcessLaunch">
                Don't run GUI in a separate process
              </label>
              <input type="checkbox" id="enableSingleProcessLaunch">
            </div>
            <div>
              <label for="disableGUISandbox">Disable GUI sandbox</label>
              <input type="checkbox" id="disableGUISandbox">
            </div>
            <div>
              <label for="disableGUIGPU">Render GUI without GPU acceleration</label>
              <input type="checkbox" id="disableGUIGPU">
            </div>
          </div>
          <div id="settingsTabs-4">
            <span id="currentTmpDLFolder" class="Inline">
              Temporary downloads: ...
            </span>
            <ul id="listOfTemporaryDownloads">
            </ul>
            <div id="clearTemporaryDownloads" class="BottomButton">
              <p style="text-align: left;">
                Clear
              </p>
            </div>
            <hr/>
            <span id="currentDehydratedCacheFolder" class="Inline">
              Devbuilds file cache: not implemented
            </span>
            <p id="dehydratedCacheSize">
              Size: 0 MiB
            </p>
            <div id="clearDehydratedCache" class="BottomButton">
              <p style="text-align: left;">
                Clear
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- DevCenter connection popup -->
    <div id="devCenterModal" class="modal">
      <div id="devCenterModalDialog" class="modal-content">

        <span id="devCenterConnectionClose" class="close"
              style="position: relative; right: 15px; top: 8px;">&times;</span>

        <div id="devCenterTabs">
          <ul>
            <li><a href="#devCenterTabs-1">Info</a></li>
            <li><a href="#devCenterTabs-2">All Builds</a></li>
          </ul>
          <div id="devCenterTabs-1">
            <div id="devCenterConnectedContent" style="display: none">
              <p id="devCenterDisconnectStatus"></p>
              <div id="disconnectFromDevCenter" class="BottomButton" style="height: 40px;">
                <p style="text-align: left; font-size: 0.8em;">
                  Logout
                </p>
              </div>
            </div>
            <div id="devCenterLoginContent">
              <p>
                Here you can link the launcher to <a
                  href="https://dev.revolutionarygamesstudio.com/">ThriveDevCenter</a>. You
                can find detailed instructions on the
                <a href="https://wiki.revolutionarygamesstudio.com/wiki/Linking_the_Launcher">
                  wiki</a>.
                You can get a link code from
                <a href="https://dev.revolutionarygamesstudio.com/me">here</a>.
              </p>
              <div>
                <span>Link code: </span>
                <input type="text" placeholder="code" id="loginLinkCode" />
              </div>
              <p id="devCenterLinkCheckMessage"></p>
              <div id="devCenterLinkCheckStatus"></div>
              <div id="loginToDevCenter" class="BottomButton" style="height: 40px;">
                <p style="text-align: left; font-size: 0.8em;">
                  Login
                </p>
              </div>
              <div id="retryLoginCode" class="BottomButton" style="height: 40px; display:
                none">
                <p style="text-align: left; font-size: 0.8em;">
                  Retry Previous Code
                </p>
              </div>
            </div>
          </div>
          <div id="devCenterTabs-2">
            <div id="devCenterConnectedDevBuilds" style="display: none">
              <p>TODO: fetch all available builds from the DevCenter...</p>
            </div>
            <div id="devCenterBuildsLoginMessage">
              <p>Login to see this content.</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Error handling data things -->
    <div id="errorOldCantStartModal" class="modal">
      <div id="errorOldCantStartModalDialog" class="modal-content">
        <p id="errorOldCantStartText">
          Error: this launcher version is (maybe)
          too old to load the current thrive version list. Please update <br/>
          your launcher. See:
          <a href="https://github.com/Revolutionary-Games/Thrive-Launcher/releases">
            releases page</a>
        </p>
      </div>
    </div>

    <!-- Crash reporting popup -->
    <div id="crashReportingModal" class="modal">
      <div id="crashReportingModalDialog" class="modal-content" style="width: 650px; max-width: 650px; max-height: 85%;
                                                                      margin-top: 2%; font-size: 0.9em;">
        <span id="crashReportingClose" class="close">&times;</span>
        <div></div>
        <div id="crashReportingContent">
          Trying to load crash reporter
        </div>
      </div>
    </div>

    <!-- Generic Error popup -->
    <div id="genericErrorModal" class="modal">
      <div id="genericErrorModalDialog" class="modal-content" style="margin-top: 15%;">
        <span id="genericErrorClose" class="close">&times;</span>
        <p id="genericErrorText">
          Error popup opened without message
        </p>
      </div>
    </div>

    <!-- New version available popup -->
    <div id="newReleaseAvailableModal" class="modal">
      <div id="newReleaseAvailableModalDialog" class="modal-content">
        <span id="newReleaseClose" class="close">&times;</span>
        <span>
          <h3>New Version Available</h3>
          <p id="newReleaseAvailableText">
            <a href="https://github.com/Revolutionary-Games/Thrive-Launcher/releases">
              releases page</a>
          </p>
        </span>
      </div>
    </div>

    <!-- Version data download failed -->
    <div id="versionDataDownloadFailedModal" class="modal">
      <div id="versionDataDownloadFailedModalDialog" class="modal-content">
        <span>
          <h3>Unable to Download Version Data</h3>
          <span id="versionDataDownloadFailedText">
          </span>
        </span>
      </div>
    </div>

    <div id="autoUpdateNotificationModal" class="modal">
      <div id="autoUpdateNotificationModalDialog" class="modal-content">
        <span>
          <span id="autoUpdateNotificationClose" class="close">&times;</span>
          <p id="autoUpdateNotification"></p>
          <button id="autoUpdateRestartButton" style="display: none;">Restart</button>
        </span>
      </div>
    </div>

  </body>
  <script>
    "use strict";

    window.$ = window.jQuery = require("jquery");
  </script>
  <script src="jquery-ui-1.12.1/jquery-ui.min.js"></script>
  <script src="./renderer.js"></script>
</html>
